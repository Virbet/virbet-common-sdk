# Библиотека фильтрации событий</h1>

<p><strong>ESL2</strong> - это класс, предназначенный для фильтрации событий различных видов спорта. Он содержит методы для создания запросов, а также вспомогательные классы и перечисления для определения операций и операторов сравнения.</p>


```kotlin
from(Sport.FOOTBALL) select {
    use(
        SCORE_TEAM_HOST gt only(5.0),
        EVENT_STATUS eq only(KtorEventStatus.LIVE),
        TEAM_HOST like or("MC Oran", "JS Kabylie")
    )
}
```

<hr/>

### Основные методы

<ul>
    <li><strong>ESL2.from(vararg sport: Sport):</strong> Создает новый экземпляр ESL2 для указанных видов спорта.</li>
    <li><strong>ESL2.select {}:</strong> Метод для описания операторов выборки событий.</li>
    <li><strong>ESL2.use(vararg operations: Operation<T>):</strong> Метод добавляет операции фильтрации в текущий запрос.</li>
    <li><strong>ESL2.not(values: Operation<T>):</strong> Возвращает инвертированную операцию фильтрации.</li>
</ul>

### Примеры использования

##### Операция равенства (eq)
Операция `eq` предназначена для фильтрации событий, удовлетворяющих определенному условию равенства. В библиотеке ESL2 она используется для сравнения значений конкретного атрибута события с указанным значением.

```kotlin
val filteredEvents = ESL2.from(Sport.FOOTBALL) select {
    use(
        TEAM_HOST eq only("FC Barcelona"),
        EVENT_STATUS eq only(KtorEventStatus.LIVE)
    )
}
```

##### Как это работает:
- Выбор атрибута: Вы выбираете атрибут события, по которому хотите провести сравнение. В примере это `TEAM_HOST` и `EVENT_STATUS`.
- Оператор `eq`: Оператор eq указывает на условие равенства.
- Значение для сравнения: Вы указываете значение, с которым сравнивается выбранный атрибут. Здесь используется функция only, чтобы создать объект OperationsGroup с одним значением.

<hr/>

##### Операция сравнения больше (gt) и меньше (lt)
Давайте рассмотрим операции сравнения `gt` (больше) и `lt` (меньше) в библиотеке ESL2.

Операция `gt` используется для фильтрации событий, где значение определенного атрибута больше указанного значения.

Пример использования операции gt для фильтрации по счету команды-хозяина:

```kotlin
val filteredEvents = ESL2.from(Sport.FOOTBALL) select {
	use(
		SCORE_TEAM_HOST gt only(3.0),
		EVENT_STATUS eq only(KtorEventStatus.LIVE)
	)
}
```

В данном примере `filteredEvents` будет содержать футбольные события, где счет команды-хозяина больше 3.0, и статус события равен "LIVE".

Операция lt используется для фильтрации событий, где значение определенного атрибута меньше указанного значения.

Пример использования операции lt для фильтрации по счету команды-хозяина:

```kotlin
val filteredEvents = ESL2.from(Sport.FOOTBALL) select {
	use(
		SCORE_TEAM_HOST lt only(5.0),
		EVENT_STATUS eq only(KtorEventStatus.LIVE)
	)
}
```

В данном примере `filteredEvents` будет содержать футбольные события, где счет команды-хозяина меньше 5.0, и статус события равен "LIVE".

<hr/>

##### Операция "подобно" (like)
Операция `like` в библиотеке ESL2 используется для фильтрации событий, где значение определенного атрибута соответствует указанному текстовому шаблону. Это позволяет осуществлять поиск по частичному совпадению строк или использовать регулярные выражения для более гибкого поиска.

Пример использования операции like для фильтрации по названию команды-гостя:


```kotlin
val filteredEvents = ESL2.from(Sport.FOOTBALL) select {
	use(
		TEAM_GUEST like or("Liverpool", "Manchester United"),
		EVENT_STATUS eq only(KtorEventStatus.LIVE)
	)
}
```
В данном примере `filteredEvents` будет содержать футбольные события, где название команды-гостя содержит подстроку "Liverpool" или "Manchester United", и статус события равен "LIVE".

###### Примечания:
- Множественные условия: Вы можете комбинировать несколько операций like в одном запросе, используя метод or.
- Использование регулярных выражений: Вместо строки можно передавать объект Regex в качестве значения для более сложных поисковых шаблонов.

<hr/>

### Философия функции not в библиотеке ESL2
Оператор `not` в библиотеке ESL2 представляет собой мощный инструмент для инверсии логики фильтрации событий. Его философия заключается в создании отрицательного условия, позволяя легко и гибко определять исключения из общего набора событий.

##### Как это работает:
Оператор `not` принимает в качестве аргумента операцию фильтрации, которую необходимо инвертировать. Например:

```kotlin
val notEqualRealMadrid = not(TEAM_HOST eq only("Real Madrid"))
```

В данном примере `notEqualRealMadrid` будет фильтровать события, где команда-хозяин не равна "Real Madrid". 

Во время построения запроса фильтрации событий, вы можете включать оператор `not` в сочетании с другими операциями:

```kotlin
val filteredEvents = ESL2.from(Sport.FOOTBALL) select {
    use(
        not(TEAM_HOST eq only("Real Madrid")),
        EVENT_STATUS eq only(KtorEventStatus.LIVE)
    )
}
```
В данном примере `filteredEvents` будет содержать футбольные события, где команда-хозяин не равна "Real Madrid", и статус события равен "LIVE".

### Принципы и философия операторов or, and и функции only в библиотеке ESL2

Операторы `or` и `and`, а также функция `only`, предоставляют мощные инструменты для создания группировок и комбинирования условий фильтрации событий в библиотеке ESL2.

##### Оператор or
Оператор or используется для создания условий "или". Это позволяет объединять несколько значений в одну группу и выбирать события, которые соответствуют хотя бы одному из этих значений.

Пример использования or для фильтрации по командам-гостям:

```kotlin
val filteredEvents = ESL2.from(Sport.FOOTBALL) select {
    use(
        TEAM_GUEST like or("Liverpool", "Manchester United"),
        EVENT_STATUS eq only(KtorEventStatus.LIVE)
    )
}
```

В данном примере `filteredEvents` будет содержать футбольные события, где команда-гость содержит подстроку "Liverpool" или "Manchester United", и статус события равен "LIVE".

##### Оператор and
Оператор and используется для создания условий "и". Это позволяет объединять несколько значений в одну группу и выбирать события, которые соответствуют всем этим значениям.

Пример использования and для фильтрации по команде-хозяину и статусу события:

```kotlin
val filteredEvents = ESL2.from(Sport.FOOTBALL) select {
	use(
		TEAM_HOST eq only("FC Barcelona"),
		EVENT_STATUS eq only(KtorEventStatus.LIVE)
	)
}
```

В данном примере `filteredEvents` будет содержать футбольные события, где команда-хозяин равна "FC Barcelona" и статус события равен "LIVE".



##### Оператор only
Функция only используется для создания группы из одного значения. Это полезно, когда требуется точно определить одно значение для сравнения.

Пример использования only для фильтрации по статусу события:

```kotlin
val filteredEvents = ESL2.from(Sport.FOOTBALL) select {
	use(
		EVENT_STATUS eq only(KtorEventStatus.LIVE),
		SCORE_TEAM_HOST gt only(3.0)
	)
}
```

В данном примере `filteredEvents` будет содержать футбольные события, где статус события равен "LIVE" и счет команды-хозяина больше 3.0.






